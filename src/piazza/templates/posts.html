<html>
<header>
<title>Piazza</title>
</header>
<body>
Hello and Welcome to the Piazza!
{% if user.is_authenticated %}
<li>User: {{ user.get_username }}</li>
<li><a href="{% url 'logout'%}?next={{request.path}}">Logout</a></li>
{% else %}
<li><a href="{% url 'login'%}?next={{request.path}}">Login</a></li>
{% endif %} 

<a href="/createpost/"><button type="button">Create a post</button></a>
<br>
<br>

<form method="get">
  <ul>
    <li>
      <button type="submit" class="button" name="topic" value="" selected>
        All Genres
      </button>
    </li>
    {% for topic in topics %}
    <li>
      <button type="submit" class="button" name="topic" value="{{ topic.id }}">
        {{ topic.name }}
      </button>
    </li>
    {% endfor %}
  </ul>
</form>

<div class="post">
    <ul>
      {% for post in filter %}
      <div class= "individualPost" style="border: thin solid black">
      <div class="topPart"><p>ID:{{post.id}}  Category:{% for topic in post.topics.all %} {{topic.name}} {% endfor %} by {{ post.poster }} at {{ post.timestamp }}<p></div>
      <section><div class="postTitle">{{ post.title }}</div>
        <p>{{post.body}}</p>
        <br />
        <div class="lowerPart"><p>Likes:{{post.likes}}  Dislikes:{{post.dislikes}}  Status:{% if post.status %}Live {% else %}Expired {% endif %} Expire time:{{ post.extimestamp }}<p></div>
        </section>
    </div>
    <div class="interactionPart">
      {% if post.status %}
    <form method="get">
    <button type="submit" class="button" name="comment" value="{{ post.id }}" formaction="/comment">
      Comment 
    </button></form>
    {% if not liked %}  <form method="get">
      <button type="submit" class="button" name="like" value="{{ post.id }}">
        Like
      </button>
      {% else %} <form method="get">
      <button type="submit" class="button" name="dontLike" value="{{ post.id }}">
        Liked
      </button>
    </form>
      {% endif %}
      {% if not disliked %}  <form method="get">
      <button type="submit" class="button" name="dislike" value="{{ post.id }}">
        Dislike
      </button>
      {% else %} <form method="get">
        <button type="submit" class="button" name="dontDislike" value="{{ post.id }}">
          Disliked
        </button>
    </form>
    {% endif %}
    </li>
    {% endif %}
    </div>
    <br>
   
    <div class="commentSection"><p>Comments: {% for comment in post.comments.all %} Commenter:{{comment.commenter}} at {{comment.timestamp}}<br>{{comment.body}}<p>{% endfor %}</div>
      <div class="posthistorySection" style="border: thin solid black"><p>Post history: {% for postaction in post.postActions.all %} Commenter:{{postaction.user}} did {{postaction.action}} at {{postaction.timestamp}} while there was {{postaction.timeLeft}} hours and {{postaction.timeLeftMinutes}} minutes left <br>{% endfor %}</div>
    </section>
    <br>
    <br>
</div>
      {% endfor %}
    </ul>
  
  </div>

</body>
</html>
